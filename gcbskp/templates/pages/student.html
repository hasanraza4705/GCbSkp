{% extends "base.html" %} {% load static i18n compress %} {% block content %}
<div class="container px-5" >
  {% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible d-flex justify-content-between align-items-center" role="alert">
                <span>{{ message }}</span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    </div>
{% endif %}
</div>

<div class="container py-4 mt-3">
    {% comment %} <h2 class="text-center mb-4"> Admission Form</h2> {% endcomment %}
    <h2>Online Admission <span class="text-primary h6">Personal Information</span></h2>

       <form id="personal-info-form" action="{% url 'student-details:add_student' %}" method="post" enctype="multipart/form-data">
     {% csrf_token %}

     <!-- Personal Information -->
      <h5 class="text-primary text-center mb-3 mt-3">Personal Information</h5>
     <div class="row">
         <div class=" col-md-4 mb-3">
             <label for="name">Name</label>
             <input type="text" class="form-control" id="name" name="name" placeholder="Enter your Name" maxlength="255">
         </div>
         <div class="col-md-4 mb-3">
            <label for="cnic_no">CNIC/B-Form</label>
            <input type="text" class="form-control" id="cnic_no" name="cnic_no" placeholder="✗✗✗✗✗-✗✗✗✗✗✗✗-✗" maxlength="15">
        </div>
        
         <div class=" col-md-3">
             <label for="photo">Photo</label>
             <input type="file" class="form-control" id="photo" name="photo">
         </div>
         <div class="col-1 mt-1">
           <img id="image-preview" src="#" alt="Selected Image"  style="max-width: 60px; max-height: 60px; display: none; object-fit: contain;">
       </div>
     </div>
     <div class="row">
         <div class=" col-md-4 mb-3">
             <label for="date_of_birth">Date of Birth</label>
             <input type="date" class="form-control" id="date_of_birth" name="date_of_birth">
         </div>
         <div class=" col-md-4 mb-3">
             <label for="mobile_no">Mobile No</label>
             <input type="text" class="form-control" id="mobile_no" name="mobile_no" placeholder="✗✗✗✗-✗✗✗✗✗✗✗" maxlength="12">
         </div>
         <div class="form-group col-md-4 mb-3">
             <label for="email">Email</label>
             <input type="email" class="form-control" id="email" name="std_email" placeholder="Enter your Email address">
         </div>
     </div>

     <!-- Father Information -->
     <h5 class="text-primary text-center mb-3 mt-3">Parent Information</h5>
     <div class="row">
         <div class="form-group col-md-4 mb-3">
             <label for="father_name">Father's Name</label>
             <input type="text" class="form-control" id="father_name" name="father_name" placeholder="Enter your Father Name" maxlength="255">
         </div>
         <div class="form-group col-md-4 mb-3">
            <label for="father_cnic">Father's CNIC</label>
            <input type="text" class="form-control" id="father_cnic" name="father_cnic" placeholder="✗✗✗✗✗-✗✗✗✗✗✗✗-✗" maxlength="15">
        </div>
         <div class="form-group col-md-4 mb-3">
             <label for="father_mobile_no">Father's Mobile No</label>
             <input type="text" class="form-control" id="father_mobile_no" name="father_mobile_no" placeholder="✗✗✗✗-✗✗✗✗✗✗✗" maxlength="12">
         </div>
     </div>
     <div class="row">

     </div>

     <!-- Guardian Information -->
     <h5 class="text-primary text-center mb-3 mt-3">Father / Guardian Information</h5>

     <div class="row">
         <div class="form-group col-md-4 mb-3">
             <label for="guardian_name">Father / Guardian's Name</label>
             <input type="text" class="form-control" id="guardian_name" name="guardian_name" placeholder="Enter your guardian name" maxlength="255">
         </div>
         <div class="form-group col-md-4 mb-3">
            <label for="guardian_cnic">Father / Guardian's CNIC</label>
            <input type="text" class="form-control" id="guardian_cnic" name="guardian_cnic" placeholder="✗✗✗✗✗-✗✗✗✗✗✗✗-✗" maxlength="15">
        </div>
         <div class="form-group col-md-4 mb-3">
             <label for="guardian_contact_no"> Father / Guardian's Contact No</label>
             <input type="text" class="form-control" id="guardian_contact_no" name="guardian_contact_no" placeholder="✗✗✗✗-✗✗✗✗✗✗✗" maxlength="12">
         </div>
     </div>
     <div class="row">

         <div class="form-group col-md-4 mb-3">
           <label for="father_occupation">Father's Occupation</label>
           <input type="text" class="form-control" id="father_occupation" name="father_occupation" placeholder="Enter your father/guardian occupation" maxlength="255">
       </div>
       <div class="col-md-4 mb-3">
         <label for="disable_status">Disability</label>
         <select class="form-control" id="disable_status" name="disabil_status">
             <option value="" selected disabled>--Select--</option>
             <option value="Yes">Yes</option>
             <option value="No">No</option>
         </select>
       </div>
       <div class="col-md-4" id="disability_div" style="display: none;">
        <label for="disability_reason" >Disability Type</label>
        <input type="text" class="form-control" name="disbility_type">
    </div>
     </div>

     <!-- Address Information -->
     <div class="row">
        <div class="form-group col-md-6 col-sm-12">
            <label for="postal_address">Postal Address</label>
            <textarea class="form-control" id="postal_address" name="postal_address" placeholder="Enter your postal address" rows="2"></textarea>
        </div>
       
         <div class="form-group col-md-6 col-sm-12">
             <label for="permanent_address">Permanent Address</label> <span> <input type="checkbox" class="mx-2" id="copy_address_checkbox"></span>  <span class="text-danger">(Same as Posral Address)</span>
             <textarea class="form-control" id="permanent_address" name="permanent_address" placeholder="Enter your permanent address" rows="2"></textarea>
         </div>
         
     </div>

     <!-- Other Information -->
     <div class="row">
         
         <div class="form-group col-md-4 mb-3">
            <label for="province">Province</label>
            <select class="form-control" id="province" name="province">
                <option value="" selected disabled>--Select--</option>
                {% for data in provinces %}
                <option value="{{ data.province }}">{{ data.province }}</option>
                {% endfor %}
            </select>
         </div>
         <div class="form-group col-md-4 mb-3">
           
            <label for="district">District</label>
            <select class="form-control" id="district" name="district">
                <option value="" selected disabled>--Select--</option>
                {% for data in districts %}
                <option value="{{ data.district }}">{{ data.district }}</option>
                {% endfor %}
            </select>
         </div>
         <div class="form-group col-md-4 mb-3">
            <label for="district">City</label>
            <input type="text" class="form-control" id="City" name="city" placeholder="Enter your City" maxlength="50">
        </div>
         
     </div>
     <div class="row">
         <div class="form-group col-md-4 mb-3">
             <label for="gender">Gender</label>
             <select class="form-control" id="gender" name="gender">
                 <option value="" selected disabled>--Select--</option>
                 <option value="Male">Male</option>
                 <option value="Female">Female</option>
                 <option value="Other">Other</option>
             </select>
         </div>
         <div class="form-group col-md-4 mb-3">
             <label for="religion">Religion</label>
             <select class="form-control" name="religion">
               <option value="" selected disabled>--Select--</option>
               <option value="Islam">Islam</option>
               <option value="Chirstan">Chirstan</option>
               <option value="Sikh">Shikh</option>
               <option value="Other">Other</option>
             </select>
         </div>
         <div class="form-group col-md-4 mb-3">
            <label for="marital_status">Marital Status</label>
            <select class="form-control" id="marital_status" name="marital_status">
                <option value="" selected disabled>--Select--</option>
                <option value="Married">Married</option>
                <option value="Unmarried">Unmarried</option>
                <option value="Divorced">Divorced</option>
            </select>
        </div>
         

     </div>
     <div class="row">
         <div class="form-group col-md-4 mb-3">
             <label for="blood_group">Blood Group</label>
             <select class="form-control" id="blood_group" name="blood_group">
               <option value="" selected disabled>--Select--</option>
               <option value="A+">A+</option>
               <option value="A-">A-</option>
               <option value="B+">B+</option>
               <option value="B-">B-</option>
               <option value="O+">O+</option>
               <option value="O-">O-</option>
               <option value="AB+">AB+</option>
               <option value="AB-">AB-</option>
             </select>
         </div>
        
         <div class="form-group col-md-4 mb-3">
            <label for="hafiz_e_quran">Hafiz-e-Quran</label>
            <select class="form-control" id="hafiz_e_quran" name="hafiz_e_quran">
                <option value="" selected disabled>--Select--</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>
        </div>
        
        <!-- This section will be shown only if "Yes" is selected -->
        <div class="form-group col-md-4" id="hafiz_document_div" style="display: none;">
            <label for="hafiz_document">Upload Hafiz-e-Quran Document</label>
            <input type="file" class="form-control" id="hafiz_document" name="hafiz_document">
        </div>

         <div class="col-md-4 mb-3">
           <label for="related_to_worker">Are you related to a college employee?</label>
           <select class="form-control" id="related_to_worker" name="related_to_worker">
               <option value="" selected disabled>--Select--</option>
               <option value="Yes">Yes</option>
               <option value="No">No</option>
           </select>
       </div>

     </div>
     <div id="employee_info_data" style="display: none;">
       <!-- Employee Worker Details Form Fields -->
       <div class="row">
           <div class="col-md-4 mb-3">
               <label for="worker_name">Employee Name</label>
               <input type="text" class="form-control" id="worker_name" name="worker_name" placeholder="Enter employee name">
           </div>
           <div class="col-md-4 mb-3">
               <label for="worker_income">Employee Relation</label>
               <input type="text" class="form-control" id="worker_income" name="worker_income" placeholder="Enter relation" step="0.01">
           </div>
           <div class="col-md-4 mb-3">
            <label for="worker_income">Employee PayScale</label>
            <input type="text" class="form-control" id="worker_income" name="worker_payscale" placeholder="Enter Paysclae" step="0.01">
        </div>
        <div class="col-md-4 mb-3">
            <label for="related_to_worker">Status / Regular</label>
           <select class="form-control" id="worker_status" name="worker_status">
               <option value="" selected disabled>--Select--</option>
               <option value="Yes">Yes</option>
               <option value="No">No</option>
           </select>
        </div>
       </div>
     </div>

     <!-- Submit Button -->
     <div class="text-center mt-4">
         <button type="submit" class="btn btn-success p-4" >Next</button>
     </div>
       </form>
   </div>
</div>




<script>

document.getElementById('photo').addEventListener('change', function(event) {
  var file = event.target.files[0];
  var reader = new FileReader();
  reader.onload = function(e) {
      var imagePreview = document.getElementById('image-preview');
      imagePreview.src = e.target.result;
      imagePreview.style.display = 'block';
  }
  if (file) {
      reader.readAsDataURL(file);
  }
}); 

const hafizSelect = document.getElementById('hafiz_e_quran');
const hafizDocumentDiv = document.getElementById('hafiz_document_div');

if (hafizSelect) {
    hafizSelect.addEventListener('change', function() {
        // Check if "Yes" (True) is selected
        if (hafizSelect.value === 'Yes') {
            hafizDocumentDiv.style.display = 'block';  // Show the document upload div
        } else {
            hafizDocumentDiv.style.display = 'none';  // Hide the document upload div
        }
    });
}

// Employee Working Visibility
const workerSelect = document.getElementById('related_to_worker');
const workerDetails = document.getElementById('employee_info_data');

if (workerSelect && workerDetails) {
    workerSelect.addEventListener('change', function() {
        console.log('Selected value:', workerSelect.value); // Check selected value in console
        if (workerSelect.value === 'Yes') {
            workerDetails.style.display = 'block';
        } else {
            workerDetails.style.display = 'none';
        }
    });

    // Initial state based on default selection
    if (workerSelect.value === 'Yes') {
        workerDetails.style.display = 'block';
    } else {
        workerDetails.style.display = 'none';
    }
}
//  code for disability
const disability_type = document.getElementById('disability_div');
const disable_status = document.getElementById('disable_status');
if(disability_type && disable_status)
   {
disable_status.addEventListener('change' , function () {
   
    if(disable_status.value == 'Yes'){
        disability_type.style.display = 'block';
    }
    else {
        disability_type.style.display= 'none'
    }

});
}
const checkbox = document.getElementById('copy_address_checkbox');
    const postalAddress = document.getElementById('postal_address');
    const permanentAddress = document.getElementById('permanent_address');

    // Function to copy postal address to permanent address if checkbox is checked
    checkbox.addEventListener('change', function() {
        if (checkbox.checked) {
            permanentAddress.value = postalAddress.value;  // Copy postal address to permanent address
        } else {
            permanentAddress.value = '';  // Clear permanent address if checkbox is unchecked
        }
    });

    // Optional: Update permanent address immediately when postal address is entered
    postalAddress.addEventListener('input', function() {
        if (checkbox.checked) {
            permanentAddress.value = postalAddress.value;
        }
    });

// Function to format the CNIC input with dashes
function formatCnic(inputElement) {
    inputElement.addEventListener('input', function(e) {
        let input = e.target.value;
        
        // Remove non-digit characters (just in case someone pastes a non-digit character)
        input = input.replace(/\D/g, '');
        
        // Add dashes after 5 and 13 characters
        if (input.length > 5 && input.length <= 13) {
            input = input.slice(0, 5) + '-' + input.slice(5);
        }
        if (input.length > 13) {
            input = input.slice(0, 13) + '-' + input.slice(13, 15);
        }

        // Set the formatted value back to the input field
        e.target.value = input;
    });
}

// Apply the format function to both CNIC fields
const fatherCnic = document.getElementById('father_cnic');
const guardianCnic = document.getElementById('guardian_cnic');

// Check if the elements exist before adding event listeners
if (fatherCnic) {
    formatCnic(fatherCnic);
}
if (guardianCnic) {
    formatCnic(guardianCnic);
}
document.getElementById('cnic_no').addEventListener('input', function(e) {
    let input = e.target.value;
    
    // Remove non-digit characters (just in case someone pastes a non-digit character)
    input = input.replace(/\D/g, '');
    
    // Add dashes after 5 and 13 characters
    if (input.length > 5 && input.length <= 13) {
        input = input.slice(0, 5) + '-' + input.slice(5);
    }
    if (input.length > 13) {
        input = input.slice(0, 13) + '-' + input.slice(13, 15);
    }

    // Set the formatted value back to the input field
    e.target.value = input;
});

</script>

{% endblock %}
